export function getBookmarkletCode(id) {
  const bookmarklets = {
    'display-color-picker': `javascript:(function(){try{var d=document,s=d.createElement('style');s.innerHTML='.cc-panel{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;border:2px solid #e67320;border-radius:12px;padding:20px;z-index:10000;font-family:Arial,sans-serif;width:420px;box-shadow:0 10px 30px rgba(0,0,0,0.3);cursor:move}.cc-header{background:#e67320;color:#fff;padding:15px;margin:-20px -20px 20px;border-radius:10px 10px 0 0;display:flex;justify-content:space-between;align-items:center}.cc-title{font-size:18px;font-weight:bold;margin:0}.cc-close{background:#dc3545;color:#fff;border:none;border-radius:50%;width:24px;height:24px;cursor:pointer;font-size:14px}.cc-close:hover{background:#c82333}.cc-controls{margin-bottom:15px}.cc-label{display:block;margin-bottom:8px;font-weight:bold;color:#333}.cc-input-group{display:flex;align-items:center;gap:10px;margin-bottom:15px}.cc-color-input{flex:1;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:monospace}.cc-picker-btn{background:#007bff;color:#fff;border:none;border-radius:4px;padding:8px 12px;cursor:pointer;font-size:12px;display:flex;align-items:center;gap:5px}.cc-picker-btn:hover{background:#0056b3}.cc-color-preview{width:40px;height:40px;border:2px solid #ccc;border-radius:4px;flex-shrink:0}.cc-results{margin-top:15px;padding:15px;background:#f8f9fa;border-radius:8px}.cc-ratio{font-size:24px;font-weight:bold;text-align:center;margin-bottom:10px}.cc-compliance{margin:10px 0}.cc-level{padding:5px 10px;margin:5px 0;border-radius:4px;font-weight:bold;text-align:center}.cc-pass{background:#28a745;color:#fff}.cc-fail{background:#dc3545;color:#fff}';d.head.appendChild(s);var p=d.createElement('div');p.className='cc-panel';p.innerHTML='<div class="cc-header"><h3 class="cc-title">🎨 Color Contrast Analyzer</h3><button class="cc-close">×</button></div><div class="cc-controls"><label class="cc-label">Foreground Color:</label><div class="cc-input-group"><input type="text" class="cc-color-input cc-foreground-text" value="#000000" readonly><button class="cc-picker-btn cc-foreground-picker">🎨 Pick</button><div class="cc-color-preview cc-fg-preview" style="background:#000000"></div></div><label class="cc-label">Background Color:</label><div class="cc-input-group"><input type="text" class="cc-color-input cc-background-text" value="#ffffff" readonly><button class="cc-picker-btn cc-background-picker">🎨 Pick</button><div class="cc-color-preview cc-bg-preview" style="background:#ffffff"></div></div></div><div class="cc-results"><div class="cc-ratio">21.00:1</div><div class="cc-compliance"><div class="cc-level cc-pass">✓ AAA (7:1)</div><div class="cc-level cc-pass">✓ AA (4.5:1)</div><div class="cc-level cc-pass">✓ A (3:1)</div></div></div>';d.body.appendChild(p);function hexToRgb(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[0,0,0]}function getLuminance(e){var t=e.map(function(e){return(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)});return t[0]*.2126+t[1]*.7152+t[2]*.0722}function getContrastRatio(e,t){var n=getLuminance(hexToRgb(e)),r=getLuminance(hexToRgb(t)),a=Math.max(n,r),i=Math.min(n,r);return((a+.05)/(i+.05)).toFixed(2)}function updateContrast(){var e=p.querySelector('.cc-foreground-text').value,t=p.querySelector('.cc-background-text').value,n=getContrastRatio(e,t);p.querySelector('.cc-ratio').textContent=n+':1';p.querySelector('.cc-fg-preview').style.background=e;p.querySelector('.cc-bg-preview').style.background=t;var r=p.querySelectorAll('.cc-level');r[0].className='cc-level '+(n>=7?'cc-pass':'cc-fail');r[0].textContent=(n>=7?'✓':'✗')+' AAA (7:1)';r[1].className='cc-level '+(n>=4.5?'cc-pass':'cc-fail');r[1].textContent=(n>=4.5?'✓':'✗')+' AA (4.5:1)';r[2].className='cc-level '+(n>=3?'cc-pass':'cc-fail');r[2].textContent=(n>=3?'✓':'✗')+' A (3:1)'}async function pickColor(t){if('EyeDropper'in window){try{var n=new EyeDropper(),r=await n.open();if(r&&r.sRGBHex){var a=t?'cc-foreground-text':'cc-background-text';p.querySelector('.'+a).value=r.sRGBHex;updateContrast()}}catch(e){alert('Color picker failed: '+e.message)}}else{alert('EyeDropper API not supported in your browser')}}p.querySelector('.cc-foreground-picker').addEventListener('click',function(){pickColor(!0)});p.querySelector('.cc-background-picker').addEventListener('click',function(){pickColor(!1)});p.querySelector('.cc-close').addEventListener('click',function(){p.remove();s.remove()});var o=!1,l={x:0,y:0};p.addEventListener('mousedown',function(e){if(!e.target.closest('.cc-close')&&!e.target.classList.contains('cc-picker-btn')){o=!0,l.x=e.clientX-p.offsetLeft,l.y=e.clientY-p.offsetTop,e.preventDefault()}});d.addEventListener('mousemove',function(e){o&&(p.style.left=e.clientX-l.x+'px',p.style.top=e.clientY-l.y+'px',p.style.transform='none')});d.addEventListener('mouseup',function(){o=!1});updateContrast()}catch(e){alert('Color Picker Error: '+e.message)}})();`,

    'mark-links-unvisited': `javascript:(function(){try{var links=document.querySelectorAll('a:visited, a:link');var count=0;var style=document.createElement('style');style.id='unvisited-links-style';style.textContent='a:visited { color: #0066cc !important; text-decoration: underline !important; } a:link { color: #0066cc !important; text-decoration: underline !important; }';if(document.getElementById('unvisited-links-style')){document.getElementById('unvisited-links-style').remove();count=0;}else{document.head.appendChild(style);count=links.length;}var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent=count>0?'✓ '+count+' links marked unvisited':'✗ Unvisited link styling removed';document.body.appendChild(msg);setTimeout(function(){msg.remove();},3000);}catch(e){alert('Error: '+e.message);}})();`,

    'outline-headings': `javascript:(function(){try{var existingStyle=document.getElementById('outline-headings-style');if(existingStyle){existingStyle.remove();document.querySelectorAll('.heading-label').forEach(function(el){el.remove();});return;}var style=document.createElement('style');style.id='outline-headings-style';style.textContent='h1,h2,h3,h4,h5,h6{outline:3px solid #e67320 !important;outline-offset:2px !important;position:relative !important;}.heading-label{position:absolute !important;top:-10px !important;left:-10px !important;background:#e67320 !important;color:white !important;padding:2px 6px !important;font-size:12px !important;font-weight:bold !important;border-radius:3px !important;z-index:9999 !important;font-family:Arial,sans-serif !important;}';document.head.appendChild(style);var headings=document.querySelectorAll('h1,h2,h3,h4,h5,h6');var count=0;headings.forEach(function(heading){var label=document.createElement('span');label.className='heading-label';label.textContent=heading.tagName;heading.appendChild(label);count++;});var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ '+count+' headings outlined';document.body.appendChild(msg);setTimeout(function(){msg.remove();},3000);}catch(e){alert('Error: '+e.message);}})();`,

    'outline-tables': `javascript:(function(){try{var existingStyle=document.getElementById('outline-tables-style');if(existingStyle){existingStyle.remove();return;}var style=document.createElement('style');style.id='outline-tables-style';style.textContent='table{outline:3px solid #e67320 !important;outline-offset:2px !important;}th{background:rgba(230,115,32,0.2) !important;outline:1px solid #e67320 !important;}td{outline:1px solid #e67320 !important;}';document.head.appendChild(style);var tables=document.querySelectorAll('table');var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ '+tables.length+' tables outlined';document.body.appendChild(msg);setTimeout(function(){msg.remove();},3000);}catch(e){alert('Error: '+e.message);}})();`,

    'clear-form-fields': `javascript:(function(){try{var inputs=document.querySelectorAll('input[type="text"],input[type="email"],input[type="password"],input[type="number"],input[type="tel"],input[type="url"],input[type="search"],textarea');var count=0;inputs.forEach(function(input){if(input.value){input.value='';count++;}});var selects=document.querySelectorAll('select');selects.forEach(function(select){if(select.selectedIndex>0){select.selectedIndex=0;count++;}});var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ '+count+' form fields cleared';document.body.appendChild(msg);setTimeout(function(){msg.remove();},3000);}catch(e){alert('Error: '+e.message);}})();`,

    'clear-radio-buttons': `javascript:(function(){try{var radios=document.querySelectorAll('input[type="radio"]:checked,input[type="checkbox"]:checked');var count=0;radios.forEach(function(radio){radio.checked=false;count++;});var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ '+count+' radio buttons/checkboxes cleared';document.body.appendChild(msg);setTimeout(function(){msg.remove();},3000);}catch(e){alert('Error: '+e.message);}})();`,

    'disable-images': `javascript:(function(){try{var existingStyle=document.getElementById('disable-images-style');if(existingStyle){existingStyle.remove();return;}var style=document.createElement('style');style.id='disable-images-style';style.textContent='img{display:none !important;}';document.head.appendChild(style);var images=document.querySelectorAll('img');var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ '+images.length+' images disabled';document.body.appendChild(msg);setTimeout(function(){msg.remove();},3000);}catch(e){alert('Error: '+e.message);}})();`,

    'display-alt-attributes': `javascript:(function(){try{document.querySelectorAll('.alt-text-overlay').forEach(function(el){el.remove();});var images=document.querySelectorAll('img');var count=0;images.forEach(function(img,index){var altText=img.getAttribute('alt');var overlay=document.createElement('div');overlay.className='alt-text-overlay';overlay.style.cssText='position:absolute;background:rgba(230,115,32,0.9);color:white;padding:5px;font-size:12px;font-family:Arial,sans-serif;border-radius:3px;z-index:9999;max-width:200px;word-wrap:break-word;';overlay.textContent=altText?'Alt: '+altText:'❌ Missing alt text';var rect=img.getBoundingClientRect();overlay.style.top=(rect.top+window.scrollY)+'px';overlay.style.left=(rect.left+window.scrollX)+'px';document.body.appendChild(overlay);count++;});var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ '+count+' image alt attributes displayed';document.body.appendChild(msg);setTimeout(function(){msg.remove();},5000);}catch(e){alert('Error: '+e.message);}})();`,

    'hide-background-images': `javascript:(function(){try{var existingStyle=document.getElementById('hide-bg-images-style');if(existingStyle){existingStyle.remove();return;}var style=document.createElement('style');style.id='hide-bg-images-style';style.textContent='*{background-image:none !important;}';document.head.appendChild(style);var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ Background images hidden';document.body.appendChild(msg);setTimeout(function(){msg.remove();},3000);}catch(e){alert('Error: '+e.message);}})();`,

    'hide-images': `javascript:(function(){try{var existingStyle=document.getElementById('hide-images-style');if(existingStyle){existingStyle.remove();return;}var style=document.createElement('style');style.id='hide-images-style';style.textContent='img{visibility:hidden !important;}';document.head.appendChild(style);var images=document.querySelectorAll('img');var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ '+images.length+' images hidden (layout preserved)';document.body.appendChild(msg);setTimeout(function(){msg.remove();},3000);}catch(e){alert('Error: '+e.message);}})();`,

    'outline-all-images': `javascript:(function(){try{var existingStyle=document.getElementById('outline-images-style');if(existingStyle){existingStyle.remove();return;}var style=document.createElement('style');style.id='outline-images-style';style.textContent='img{outline:3px solid #e67320 !important;outline-offset:2px !important;}';document.head.appendChild(style);var images=document.querySelectorAll('img');var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ '+images.length+' images outlined';document.body.appendChild(msg);setTimeout(function(){msg.remove();},3000);}catch(e){alert('Error: '+e.message);}})();`,

    'outline-background-images': `javascript:(function(){try{var existingStyle=document.getElementById('outline-bg-images-style');if(existingStyle){existingStyle.remove();document.querySelectorAll('.bg-image-label').forEach(function(el){el.remove();});return;}var style=document.createElement('style');style.id='outline-bg-images-style';style.textContent='.bg-image-element{outline:3px solid #e67320 !important;outline-offset:2px !important;position:relative !important;}.bg-image-label{position:absolute !important;top:5px !important;left:5px !important;background:#e67320 !important;color:white !important;padding:2px 6px !important;font-size:12px !important;border-radius:3px !important;z-index:9999 !important;font-family:Arial,sans-serif !important;}';document.head.appendChild(style);var elements=document.querySelectorAll('*');var count=0;elements.forEach(function(el){var bgImage=window.getComputedStyle(el).backgroundImage;if(bgImage&&bgImage!=='none'){el.classList.add('bg-image-element');var label=document.createElement('span');label.className='bg-image-label';label.textContent='BG IMG';el.appendChild(label);count++;}});var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ '+count+' elements with background images outlined';document.body.appendChild(msg);setTimeout(function(){msg.remove();},3000);}catch(e){alert('Error: '+e.message);}})();`,

    'focus-order': `javascript:(function(){try{var existingElements=document.querySelectorAll('.focusorder-panel, .focusorder-style, .focusorder-highlight, .focus-flow-line');existingElements.forEach(function(el){el.remove();});var styles=document.createElement('style');styles.className='focusorder-style';styles.innerHTML='.focusorder-panel{position:fixed;top:20px;left:20px;background:rgba(255,255,255,0.98);border:1px solid #ddd;border-radius:12px;padding:0;z-index:10000;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Arial,sans-serif;font-size:13px;width:540px;min-width:400px;max-width:90vw;height:650px;min-height:400px;max-height:90vh;overflow:hidden;box-shadow:0 12px 35px rgba(0,0,0,0.2);resize:both;}.focusorder-header{padding:20px;background:linear-gradient(135deg,rgba(0,123,255,0.1),rgba(0,123,255,0.05));border-bottom:1px solid #eee;position:relative;cursor:move;display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:10px;}.focusorder-content{padding:20px;height:calc(100% - 140px);overflow-y:auto;cursor:default;}.focusorder-title{color:#007bff;font-size:18px;font-weight:600;margin:0 0 10px 0;cursor:move;justify-self:center;}.focusorder-subtitle{color:#666;font-size:12px;margin:0 0 15px 0;cursor:move;grid-column:2;}.focusorder-status{display:flex;align-items:center;gap:8px;margin-bottom:15px;font-weight:600;}.focusorder-pass{background:#28a745;color:white;padding:4px 12px;border-radius:16px;font-size:11px;}.focusorder-fail{background:#dc3545;color:white;padding:4px 12px;border-radius:16px;font-size:11px;}.focusorder-section{background:rgba(248,249,250,0.8);border:1px solid #dee2e6;border-radius:8px;margin:10px 0;padding:15px;}.focusorder-section.success{background:rgba(212,237,218,0.8);border-color:#badbcc;}.focusorder-section.error{background:rgba(248,215,218,0.8);border-color:#f1aeb5;}.focusorder-section.warning{background:rgba(255,243,205,0.8);border-color:#ffeaa7;}.focusorder-violation-item{margin:8px 0;padding:12px;background:rgba(220,53,69,0.1);border-left:4px solid #dc3545;border-radius:4px;position:relative;}.focusorder-accessibility-item{margin:8px 0;padding:12px;background:rgba(255,193,7,0.1);border-left:4px solid #ffc107;border-radius:4px;position:relative;}.focusorder-close{position:absolute;top:15px;right:15px;background:#dc3545;color:white;border:none;border-radius:50%;width:24px;height:24px;font-size:12px;cursor:pointer;grid-column:3;}.focusorder-close:hover{background:#c82333;transform:scale(1.1);}.focusorder-btn{background:#007bff;color:white;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;font-weight:500;margin:5px 5px 5px 0;transition:all 0.2s;}.focusorder-btn:hover{background:#0056b3;transform:translateY(-1px);}.focusorder-btn:active{transform:translateY(0);}.focusorder-inspect-btn{position:absolute;top:8px;right:8px;background:linear-gradient(135deg,#dc3545,#c82333);color:white;border:none;border-radius:4px;padding:4px 8px;font-size:9px;font-weight:bold;cursor:pointer;transition:all 0.2s;}.focusorder-inspect-btn.warning{background:linear-gradient(135deg,#ffc107,#e0a800);color:#000;}.focusorder-inspect-btn:hover{transform:translateY(-1px);}.focusorder-controls{padding:15px 20px;background:rgba(255,255,255,0.98);border-top:1px solid #eee;position:absolute;bottom:0;left:0;right:0;}.focusorder-highlight{outline:3px solid #007bff !important;outline-offset:2px !important;background-color:rgba(0,123,255,0.1) !important;position:relative !important;z-index:9999 !important;}.focusorder-highlight::before{content:attr(data-focus-order) !important;position:absolute;top:-25px;left:0;background:#007bff;color:white;font-size:10px;font-weight:bold;padding:2px 6px;border-radius:3px;z-index:10000;}.focusorder-error{outline:4px solid #dc3545 !important;outline-offset:3px !important;background-color:rgba(220,53,69,0.15) !important;position:relative !important;z-index:9999 !important;}.focusorder-error::before{background:#dc3545 !important;content:"ERROR" !important;position:absolute;top:-30px;left:0;color:white;font-size:10px;font-weight:bold;padding:3px 8px;border-radius:3px;z-index:10000;}.focusorder-accessibility-error{outline:4px solid #ffc107 !important;outline-offset:3px !important;background-color:rgba(255,193,7,0.15) !important;position:relative !important;z-index:9999 !important;}.focusorder-accessibility-error::before{background:#ffc107 !important;content:"MOUSE-ONLY" !important;position:absolute;top:-30px;left:0;color:#000;font-size:9px;font-weight:bold;padding:3px 8px;border-radius:3px;z-index:10000;}.focusorder-current-focus{outline:4px solid #28a745 !important;outline-offset:4px !important;background-color:rgba(40,167,69,0.2) !important;box-shadow:0 0 15px rgba(40,167,69,0.5) !important;}.focus-flow-line{position:absolute;pointer-events:none;z-index:9998;}.focus-flow-line-path{stroke:#007bff;stroke-width:2;fill:none;stroke-dasharray:5,5;animation:dash 1s linear infinite;}.focus-flow-arrow{fill:#007bff;}.focus-flow-number{fill:#007bff;font-family:Arial,sans-serif;font-size:12px;font-weight:bold;}@keyframes dash{to{stroke-dashoffset:-10;}}.focusorder-resize-handle{position:absolute;background:transparent;}.focusorder-resize-handle.corner{width:15px;height:15px;}.focusorder-resize-handle.edge{background:rgba(0,123,255,0.1);}.focusorder-resize-handle.edge:hover{background:rgba(0,123,255,0.2);}.focusorder-resize-se{bottom:0;right:0;cursor:se-resize;}.focusorder-resize-s{bottom:0;left:15px;right:15px;height:5px;cursor:s-resize;}.focusorder-resize-e{right:0;top:15px;bottom:15px;width:5px;cursor:e-resize;}.focusorder-resize-sw{bottom:0;left:0;cursor:sw-resize;}.focusorder-resize-w{left:0;top:15px;bottom:15px;width:5px;cursor:w-resize;}.focusorder-resize-nw{top:0;left:0;cursor:nw-resize;}.focusorder-resize-n{top:0;left:15px;right:15px;height:5px;cursor:n-resize;}.focusorder-resize-ne{top:0;right:0;cursor:ne-resize;}.focusorder-logo{width:48px;height:48px;object-fit:contain;border-radius:4px;}';document.head.appendChild(styles);var focusableElements=[];var violations=[];var accessibilityIssues=[];var tabSimulationRunning=false;var currentFocusIndex=0;var tabInterval;var flowLines=[];var currentlyInspecting=null;function getFocusableElements(){var selector='a[href]:not([tabindex="-1"]), button:not([disabled]):not([tabindex="-1"]), input:not([disabled]):not([tabindex="-1"]), select:not([disabled]):not([tabindex="-1"]), textarea:not([disabled]):not([tabindex="-1"]), [tabindex]:not([tabindex="-1"]), [contenteditable="true"]';var elements=document.querySelectorAll(selector);var visible=[];Array.from(elements).forEach(function(el){if(isElementVisible(el)&&!isInTable(el)&&!el.closest('.focusorder-panel')){visible.push(el);}});return visible.sort(function(a,b){var aIndex=parseInt(a.getAttribute('tabindex'))||0;var bIndex=parseInt(b.getAttribute('tabindex'))||0;if(aIndex>0&&bIndex>0)return aIndex-bIndex;if(aIndex>0)return -1;if(bIndex>0)return 1;return getElementOrder(a)-getElementOrder(b);});}function isElementVisible(el){var rect=el.getBoundingClientRect();var style=window.getComputedStyle(el);return rect.width>0&&rect.height>0&&style.visibility!=='hidden'&&style.display!=='none'&&style.opacity!=='0';}function isInTable(el){return!!el.closest('table, [role="table"], [role="grid"]');}function getElementOrder(el){var walker=document.createTreeWalker(document.body,NodeFilter.SHOW_ELEMENT);var order=0;while(walker.nextNode()){if(walker.currentNode===el)return order;order++;}return order;}function getElementPosition(el){var rect=el.getBoundingClientRect();var scrollTop=window.pageYOffset||document.documentElement.scrollTop;var scrollLeft=window.pageXOffset||document.documentElement.scrollLeft;return{x:rect.left+rect.width/2+scrollLeft,y:rect.top+rect.height/2+scrollTop,rect:rect,element:el};}function areElementsInSameContainer(el1,el2){var container1=el1.closest('section, article, .card, .news-item, .container, .column, .item, [class*="card"], [class*="item"], [class*="box"]');var container2=el2.closest('section, article, .card, .news-item, .container, .column, .item, [class*="card"], [class*="item"], [class*="box"]');if(container1&&container2){return container1===container2;}var rect1=el1.getBoundingClientRect();var rect2=el2.getBoundingClientRect();var verticalOverlap=!(rect1.bottom<rect2.top||rect2.bottom<rect1.top);var horizontalOverlap=!(rect1.right<rect2.left||rect2.right<rect1.left);return verticalOverlap&&horizontalOverlap;}function detectSlickCarouselIssues(){var issues=[];var slickDots=document.querySelectorAll('.slick-dots li, [class*="slick"] [role="tablist"] li, [class*="carousel"] [role="tablist"] li, [class*="slider"] [role="tablist"] li, ul.slick-dots li');Array.from(slickDots).forEach(function(dotLi){var hasButton=dotLi.querySelector('button');var hasClickHandler=dotLi.onclick||dotLi.getAttribute('onclick');var hasMouseEvents=dotLi.onmousedown||dotLi.onmouseup||dotLi.getAttribute('onmousedown')||dotLi.getAttribute('onmouseup');var hasRole=dotLi.getAttribute('role');var parentRole=dotLi.parentElement?dotLi.parentElement.getAttribute('role'):'';var tabindex=dotLi.getAttribute('tabindex');var isInteractive=hasClickHandler||hasMouseEvents||dotLi.style.cursor==='pointer'||getComputedStyle(dotLi).cursor==='pointer';if(isInteractive&&!hasButton&&tabindex==='-1'){issues.push({type:'SLICK_DOTS_MOUSE_ONLY',element:dotLi,description:'Slick carousel dots are mouse-only interactive (should use buttons)',details:'Carousel navigation dots with role="presentation" or in tablist but not keyboard accessible',fix:'Replace li elements with button elements or add proper tabindex and keyboard handlers',severity:'CRITICAL'});}else if(isInteractive&&!hasButton&&!tabindex){issues.push({type:'SLICK_DOTS_MISSING_TABINDEX',element:dotLi,description:'Slick carousel dots missing keyboard accessibility',details:'Interactive carousel dots without proper focus management',fix:'Add tabindex="0" and keyboard event handlers, or use button elements',severity:'HIGH'});}else if(hasRole==='presentation'&&isInteractive){issues.push({type:'ROLE_PRESENTATION_INTERACTIVE',element:dotLi,description:'Interactive element with role="presentation" (accessibility conflict)',details:'Element marked as presentational but has interactive behavior',fix:'Remove role="presentation" or make element non-interactive',severity:'HIGH'});}});var slickArrows=document.querySelectorAll('.slick-prev, .slick-next, [class*="slick-arrow"], [class*="carousel-arrow"], [class*="slider-arrow"]');Array.from(slickArrows).forEach(function(arrow){var isButton=arrow.tagName.toLowerCase()==='button';var hasTabindex=arrow.getAttribute('tabindex');var isDisabled=arrow.hasAttribute('disabled')||arrow.getAttribute('aria-disabled')==='true';if(!isButton&&!hasTabindex){issues.push({type:'SLICK_ARROW_NOT_BUTTON',element:arrow,description:'Carousel arrow is not a button element',details:'Navigation arrows should be button elements for proper keyboard access',fix:'Use <button> element instead of div/span for carousel arrows',severity:'MEDIUM'});}});return issues;}function analyzeReadingOrder(){var elements=getFocusableElements();focusableElements=elements;violations=[];accessibilityIssues=detectSlickCarouselIssues();for(var i=0;i<elements.length-1;i++){var current=elements[i];var next=elements[i+1];var currentPos=getElementPosition(current);var nextPos=getElementPosition(next);var violation=checkFocusTransition(current,next,currentPos,nextPos);if(violation){violations.push(violation);}}var totalIssues=violations.length+accessibilityIssues.length;return{totalElements:elements.length,violations:violations,accessibilityIssues:accessibilityIssues,totalIssues:totalIssues,compliance:totalIssues===0?'pass':'fail'};}function checkFocusTransition(current,next,currentPos,nextPos){var deltaX=nextPos.x-currentPos.x;var deltaY=nextPos.y-currentPos.y;var violationType=null;var description='';var inSameContainer=areElementsInSameContainer(current,next);if(inSameContainer){if(Math.abs(deltaY)<50){if(deltaX<-50){violationType='RIGHT_TO_LEFT';description='Focus moves from right to left within same container (should be left to right)';}}else if(Math.abs(deltaX)<100){if(deltaY<-50){violationType='BOTTOM_TO_TOP';description='Focus moves from bottom to top within same container (should be top to bottom)';}}}if(violationType){var containerName=getContainerName(current.closest('section, article, .card, .news-item, .container, .column, .item, [class*="card"], [class*="item"], [class*="box"]'))||'Unknown Container';return{type:violationType,description:description,container:containerName,currentElement:current,nextElement:next,currentPos:currentPos,nextPos:nextPos,inSameContainer:inSameContainer};}return null;}function getContainerName(container){if(!container)return'Document';var tagName=container.tagName.toLowerCase();var role=container.getAttribute('role');var id=container.id;var className=container.className;if(role)return role.toUpperCase();if(id)return tagName.toUpperCase()+' #'+id;if(className){var relevantClass=className.split(' ').find(function(cls){return cls.includes('card')||cls.includes('item')||cls.includes('news')||cls.includes('container')||cls.includes('section')||cls.includes('slick');});if(relevantClass)return tagName.toUpperCase()+' .'+relevantClass;}return tagName.toUpperCase();}function inspectViolation(violation){if(currentlyInspecting){currentlyInspecting.classList.remove('focusorder-error');}violation.currentElement.classList.add('focusorder-error');violation.nextElement.classList.add('focusorder-error');currentlyInspecting=violation;violation.currentElement.scrollIntoView({behavior:'smooth',block:'center'});setTimeout(function(){violation.nextElement.scrollIntoView({behavior:'smooth',block:'center'});},1500);}function inspectAccessibilityIssue(issue){if(currentlyInspecting){currentlyInspecting.classList.remove('focusorder-accessibility-error');}issue.element.classList.add('focusorder-accessibility-error');currentlyInspecting=issue;issue.element.scrollIntoView({behavior:'smooth',block:'center'});}function createFlowLines(){clearFlowLines();if(focusableElements.length<2)return;for(var i=0;i<focusableElements.length-1;i++){var currentEl=focusableElements[i];var nextEl=focusableElements[i+1];var currentPos=getElementPosition(currentEl);var nextPos=getElementPosition(nextEl);createFlowLine(currentPos,nextPos,i+1);}}function createFlowLine(startPos,endPos,index){var svg=document.createElementNS('http://www.w3.org/2000/svg','svg');svg.className='focus-flow-line';svg.style.position='absolute';svg.style.top='0';svg.style.left='0';svg.style.width='100%';svg.style.height=Math.max(document.documentElement.scrollHeight,window.innerHeight)+'px';svg.style.pointerEvents='none';svg.style.zIndex='9998';var path=document.createElementNS('http://www.w3.org/2000/svg','path');var midX=(startPos.x+endPos.x)/2;var midY=(startPos.y+endPos.y)/2;var pathData='M '+startPos.x+' '+startPos.y+' Q '+midX+' '+midY+' '+endPos.x+' '+endPos.y;path.setAttribute('d',pathData);path.setAttribute('class','focus-flow-line-path');var arrowSize=8;var angle=Math.atan2(endPos.y-startPos.y,endPos.x-startPos.x);var arrowX=endPos.x-arrowSize*Math.cos(angle);var arrowY=endPos.y-arrowSize*Math.sin(angle);var arrow=document.createElementNS('http://www.w3.org/2000/svg','polygon');var arrowPoints=(endPos.x)+','+(endPos.y)+' '+(arrowX-arrowSize*Math.sin(angle))+','+(arrowY+arrowSize*Math.cos(angle))+' '+(arrowX+arrowSize*Math.sin(angle))+','+(arrowY-arrowSize*Math.cos(angle));arrow.setAttribute('points',arrowPoints);arrow.setAttribute('class','focus-flow-arrow');var numberX=midX;var numberY=midY-5;var text=document.createElementNS('http://www.w3.org/2000/svg','text');text.setAttribute('x',numberX);text.setAttribute('y',numberY);text.setAttribute('class','focus-flow-number');text.textContent=index;svg.appendChild(path);svg.appendChild(arrow);svg.appendChild(text);document.body.appendChild(svg);flowLines.push(svg);}function clearFlowLines(){flowLines.forEach(function(line){if(line.parentNode){line.parentNode.removeChild(line);}});flowLines=[];}function visualizeFocusOrder(){clearVisualization();focusableElements.forEach(function(el,index){el.classList.add('focusorder-highlight');el.setAttribute('data-focus-order',index+1);});createFlowLines();}function clearVisualization(){var highlighted=document.querySelectorAll('.focusorder-highlight, .focusorder-error, .focusorder-accessibility-error, .focusorder-current-focus');highlighted.forEach(function(el){el.classList.remove('focusorder-highlight','focusorder-error','focusorder-accessibility-error','focusorder-current-focus');el.removeAttribute('data-focus-order');});clearFlowLines();if(tabInterval){clearInterval(tabInterval);tabInterval=null;}tabSimulationRunning=false;currentFocusIndex=0;currentlyInspecting=null;}function simulateTabOrder(){if(tabSimulationRunning){clearVisualization();return;}if(focusableElements.length===0){alert('No focusable elements found to simulate.');return;}tabSimulationRunning=true;currentFocusIndex=0;visualizeFocusOrder();function focusNext(){if(currentFocusIndex<focusableElements.length){var prevEl=document.querySelector('.focusorder-current-focus');if(prevEl){prevEl.classList.remove('focusorder-current-focus');}var currentEl=focusableElements[currentFocusIndex];currentEl.classList.add('focusorder-current-focus');try{currentEl.focus();currentEl.scrollIntoView({behavior:'smooth',block:'center'});}catch(e){}currentFocusIndex++;if(currentFocusIndex>=focusableElements.length){setTimeout(function(){clearVisualization();},1000);}}else{clearVisualization();}}tabInterval=setInterval(focusNext,1200);}function setupPanelResize(panel){var isResizing=false;var resizeType='';var startX,startY,startWidth,startHeight,startLeft,startTop;function createResizeHandles(){var handles=[{class:'focusorder-resize-nw corner',cursor:'nw-resize'},{class:'focusorder-resize-n edge',cursor:'n-resize'},{class:'focusorder-resize-ne corner',cursor:'ne-resize'},{class:'focusorder-resize-e edge',cursor:'e-resize'},{class:'focusorder-resize-se corner',cursor:'se-resize'},{class:'focusorder-resize-s edge',cursor:'s-resize'},{class:'focusorder-resize-sw corner',cursor:'sw-resize'},{class:'focusorder-resize-w edge',cursor:'w-resize'}];handles.forEach(function(handle){var div=document.createElement('div');div.className='focusorder-resize-handle '+handle.class;div.style.cursor=handle.cursor;panel.appendChild(div);});}createResizeHandles();panel.addEventListener('mousedown',function(e){var resizeHandle=e.target.closest('.focusorder-resize-handle');if(resizeHandle){isResizing=true;resizeType=resizeHandle.className.split(' ')[2];startX=e.clientX;startY=e.clientY;startWidth=parseInt(getComputedStyle(panel).width);startHeight=parseInt(getComputedStyle(panel).height);startLeft=panel.offsetLeft;startTop=panel.offsetTop;e.preventDefault();}});document.addEventListener('mousemove',function(e){if(!isResizing)return;var deltaX=e.clientX-startX;var deltaY=e.clientY-startY;var newWidth=startWidth;var newHeight=startHeight;var newLeft=startLeft;var newTop=startTop;switch(resizeType){case'se':newWidth=Math.max(400,startWidth+deltaX);newHeight=Math.max(400,startHeight+deltaY);break;case'e':newWidth=Math.max(400,startWidth+deltaX);break;case's':newHeight=Math.max(400,startHeight+deltaY);break;case'sw':newWidth=Math.max(400,startWidth-deltaX);newHeight=Math.max(400,startHeight+deltaY);newLeft=startLeft+deltaX;break;case'w':newWidth=Math.max(400,startWidth-deltaX);newLeft=startLeft+deltaX;break;case'nw':newWidth=Math.max(400,startWidth-deltaX);newHeight=Math.max(400,startHeight-deltaY);newLeft=startLeft+deltaX;newTop=startTop+deltaY;break;case'n':newHeight=Math.max(400,startHeight-deltaY);newTop=startTop+deltaY;break;case'ne':newWidth=Math.max(400,startWidth+deltaX);newHeight=Math.max(400,startHeight-deltaY);newTop=startTop+deltaY;break;}panel.style.width=Math.min(newWidth,window.innerWidth*0.9)+'px';panel.style.height=Math.min(newHeight,window.innerHeight*0.9)+'px';panel.style.left=Math.max(0,Math.min(newLeft,window.innerWidth-panel.offsetWidth))+'px';panel.style.top=Math.max(0,Math.min(newTop,window.innerHeight-panel.offsetHeight))+'px';});document.addEventListener('mouseup',function(){isResizing=false;resizeType='';});}function createPanel(results){var panel=document.createElement('div');panel.className='focusorder-panel';var isDragging=false;var currentX=20;var currentY=20;var initialX=0;var initialY=0;var header=document.createElement('div');header.className='focusorder-header';var content=document.createElement('div');content.className='focusorder-content';var controls=document.createElement('div');controls.className='focusorder-controls';var violationsList='';if(results.violations.length>0){violationsList=results.violations.map(function(v,i){return'<div class="focusorder-violation-item"><strong>Focus Order Violation '+(i+1)+':</strong> '+v.description+'<br><strong>Container:</strong> '+v.container+'<br><strong>Type:</strong> '+v.type+'<br><strong>Same Container:</strong> '+(v.inSameContainer?'Yes (VIOLATION)':'No (Acceptable)')+'<button class="focusorder-inspect-btn" onclick="inspectViolation(violations['+i+'])">Inspect</button></div>';}).join('');}var accessibilityList='';if(results.accessibilityIssues.length>0){accessibilityList=results.accessibilityIssues.map(function(issue,i){return'<div class="focusorder-accessibility-item"><strong>Accessibility Issue '+(i+1)+':</strong> '+issue.description+'<br><strong>Type:</strong> '+issue.type+'<br><strong>Details:</strong> '+issue.details+'<br><strong>Fix:</strong> '+issue.fix+'<br><strong>Severity:</strong> '+issue.severity+'<button class="focusorder-inspect-btn warning" onclick="inspectAccessibilityIssue(accessibilityIssues['+i+'])">Inspect</button></div>';}).join('');}var issuesList='';if(results.violations.length===0&&results.accessibilityIssues.length===0){issuesList='<div style="color:#28a745;">✅ No focus order violations or accessibility issues detected</div>';}header.innerHTML='<img class="focusorder-logo" src="https://www.tsqsinc.com/static/media/logo-transparent.1f4456ea770d124c21cb.gif" alt="TSQS Inc" decoding="async" referrerpolicy="no-referrer"><h3 class="focusorder-title">⚡ WCAG 2.4.3 Focus Order</h3><button class="focusorder-close" aria-label="Close dialog">×</button><p class="focusorder-subtitle">Success Criterion 2.4.3 — Focus Order (Level A)</p>';content.innerHTML='<div class="focusorder-status"><strong>Compliance Status:</strong><span class="focusorder-'+(results.compliance==='pass'?'pass':'fail')+'">'+(results.compliance==='pass'?'PASS':'FAIL')+'</span></div><div style="margin-bottom:15px;"><strong>Total Focusable Elements:</strong> '+results.totalElements+'<br><strong>Focus Order Violations:</strong> '+results.violations.length+'<br><strong>Accessibility Issues:</strong> '+results.accessibilityIssues.length+'<br><strong>Total Issues:</strong> '+results.totalIssues+'</div>'+(results.compliance==='pass'?'<div class="focusorder-section success"><strong>✅ Compliance Confirmed</strong><br>Focus follows Document Object Model (DOM) order<br>All focus transitions are logical<br>No carousel/slider accessibility issues found</div>':'')+violationsList+(results.violations.length>0&&results.accessibilityIssues.length>0?'':'')+accessibilityList+issuesList+'<div class="focusorder-section"><strong>🔧 Focus Order & Accessibility Rules</strong><br><strong>✅ PASS:</strong> Left to right focus within same container<br><strong>✅ PASS:</strong> Top to bottom focus within same container<br><strong>✅ PASS:</strong> Container-to-container movement (any direction)<br><strong>✅ PASS:</strong> Carousel dots implemented as buttons<br><strong>❌ FAIL:</strong> Right to left focus within same container<br><strong>❌ FAIL:</strong> Bottom to top focus within same container<br><strong>❌ FAIL:</strong> Slick carousel dots with role="presentation" but interactive<br><strong>❌ FAIL:</strong> Mouse-only interactive carousel elements</div><div class="focusorder-section"><strong>🎠 Carousel/Slider Detection</strong><br>Detects Slick carousel, slider, and similar components<br>Flags mouse-only interactive dots and arrows<br>Checks for proper button implementation<br>Validates role attributes vs interactive behavior<br>Ensures keyboard accessibility for all carousel controls</div>';controls.innerHTML='<button class="focusorder-btn" onclick="visualizeFocusOrder()">Show Focus Order</button><button class="focusorder-btn" onclick="clearVisualization()">Clear Highlights</button><button class="focusorder-btn" onclick="simulateTabOrder()">'+(tabSimulationRunning?'Stop':'Start')+' Tab Simulation</button>';panel.appendChild(header);panel.appendChild(content);panel.appendChild(controls);header.addEventListener('mousedown',function(e){if(e.target.className.indexOf('focusorder-btn')!==-1||e.target.className==='focusorder-close'||e.target.closest('.focusorder-resize-handle')||e.target.closest('.focusorder-inspect-btn')||e.target.className==='focusorder-logo')return;isDragging=true;initialX=e.clientX-currentX;initialY=e.clientY-currentY;e.preventDefault();});document.addEventListener('mousemove',function(e){if(isDragging){e.preventDefault();currentX=e.clientX-initialX;currentY=e.clientY-initialY;var maxX=window.innerWidth-panel.offsetWidth-10;var maxY=window.innerHeight-panel.offsetHeight-10;currentX=Math.max(10,Math.min(currentX,maxX));currentY=Math.max(10,Math.min(currentY,maxY));panel.style.left=currentX+'px';panel.style.top=currentY+'px';}});document.addEventListener('mouseup',function(){isDragging=false;});setupPanelResize(panel);panel.querySelector('.focusorder-close').onclick=function(){clearVisualization();panel.remove();document.querySelector('.focusorder-style').remove();};return panel;}window.visualizeFocusOrder=visualizeFocusOrder;window.clearVisualization=clearVisualization;window.simulateTabOrder=simulateTabOrder;window.inspectViolation=inspectViolation;window.inspectAccessibilityIssue=inspectAccessibilityIssue;window.violations=violations;window.accessibilityIssues=accessibilityIssues;var results=analyzeReadingOrder();var panel=createPanel(results);document.body.appendChild(panel);console.log('⚡ WCAG 2.4.3 Focus Order Analysis Complete!');console.log('Total focusable elements:',results.totalElements);console.log('Focus Order Violations:',results.violations.length);console.log('Accessibility Issues:',results.accessibilityIssues.length);console.log('Total Issues:',results.totalIssues);console.log('Compliance:',results.compliance.toUpperCase());if(results.accessibilityIssues.length>0){console.group('🎠 Carousel/Slider Accessibility Issues');results.accessibilityIssues.forEach(function(issue,i){console.log('Issue '+(i+1)+':',issue.description);console.log(' Type:',issue.type);console.log(' Element:',issue.element);console.log(' Severity:',issue.severity);console.log(' Fix:',issue.fix);});console.groupEnd();}if(results.violations.length>0){console.group('❌ Focus Order Violations (Same Container Only)');results.violations.forEach(function(v,i){console.log('Violation '+(i+1)+':',v.description);console.log(' Container:',v.container);console.log(' Type:',v.type);console.log(' Same Container:',v.inSameContainer);console.log(' Current element:',v.currentElement);console.log(' Next element:',v.nextElement);});console.groupEnd();}else{console.log('✅ All focus transitions follow logical order within containers');}console.log('💡 Focus order follows Document Object Model (DOM) order within containers');}catch(e){alert('Focus Order Analysis Error: '+e.message);}})();`,

    'keyboard': `javascript:(function(){try{var existing=document.querySelectorAll('.keyboard-panel,.keyboard-style');existing.forEach(function(el){el.remove()});var styles=document.createElement('style');styles.className='keyboard-style';styles.innerHTML='.keyboard-panel{position:fixed;top:20px;left:50%;transform:translateX(-50%);max-width:520px;width:90%;background:rgba(255,255,255,0.98);border:1px solid #ddd;border-radius:12px;padding:20px;z-index:10000;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Arial,sans-serif;font-size:13px;box-shadow:0 12px 35px rgba(0,0,0,0.2);cursor:move;}.keyboard-header{position:relative;margin-bottom:15px;min-height:48px;}.keyboard-logo{width:48px;height:48px;object-fit:contain;border-radius:4px;float:left;margin-right:12px;}.keyboard-title{color:#007bff;font-size:18px;font-weight:600;margin:0;line-height:48px;text-align:center;}.keyboard-subtitle{color:#666;font-size:12px;margin:0 0 15px 0;clear:both;}.keyboard-status{display:flex;align-items:center;gap:8px;margin-bottom:15px;font-weight:600;}.keyboard-pass{background:#28a745;color:white;padding:4px 12px;border-radius:16px;font-size:11px;}.keyboard-fail{background:#dc3545;color:white;padding:4px 12px;border-radius:16px;font-size:11px;}.keyboard-section{background:rgba(248,249,250,0.8);border:1px solid #dee2e6;border-radius:8px;margin:10px 0;padding:15px;}.keyboard-section.success{background:rgba(212,237,218,0.8);border-color:#badbcc;}.keyboard-section.error{background:rgba(248,215,218,0.8);border-color:#f1aeb5;}.keyboard-close{position:absolute;top:15px;right:15px;background:#dc3545;color:white;border:none;border-radius:50%;width:24px;height:24px;font-size:12px;cursor:pointer;}.keyboard-close:hover{background:#c82333;}.keyboard-table{width:100%;border-collapse:collapse;font-size:12px;}.keyboard-table th{background:#f8f9fa;font-weight:600;padding:8px;text-align:left;border-bottom:2px solid #dee2e6;}.keyboard-table td{padding:8px;border-bottom:1px solid #eee;vertical-align:top;}.keyboard-btn{background:#007bff;color:white;border:none;border-radius:6px;padding:4px 8px;cursor:pointer;font-size:11px;}.keyboard-btn:hover{background:#0069d9;}';document.head.appendChild(styles);function addOverlay(n){document.body.appendChild(n)}function clearAll(){document.querySelectorAll('.__a11y-mark').forEach(el=>el.remove());document.removeEventListener('keydown',esc,true)}function esc(e){if(e.key==='Escape'){clearAll()}}document.addEventListener('keydown',esc,true);function safeAttr(el,n){try{return el&&el.getAttribute?el.getAttribute(n):null}catch(e){return null}}function isInsideWidget(el){return el&&el.closest('.keyboard-panel')}function isVisible(el){try{var s=getComputedStyle(el);var r=el.getBoundingClientRect();return s&&s.display!=='none'&&s.visibility!=='hidden'&&r.width>0&&r.height>0}catch(e){return false}}function hasInteractiveRole(el){var r=safeAttr(el,'role');return r&&/(button|link|checkbox|radio|switch|menuitem|option|tab|combobox|textbox|spinbutton|slider|treeitem)/i.test(r)}function hasClickLike(el){try{return el.hasAttribute&&(el.hasAttribute('onclick')||el.hasAttribute('onmousedown')||el.hasAttribute('onmouseup')||el.hasAttribute('onpointerdown')||el.hasAttribute('onpointerup')||el.hasAttribute('ontouchstart')||el.hasAttribute('ontouchend'))||/%08(btn|button|clickable|tap|chip|pill|card|menu-item)%08/i.test(el.className)}catch(e){return false}}function isInteractive(el){return hasClickLike(el)||hasInteractiveRole(el)||(el.tagName||'').toLowerCase()==='a'}function isNativeTabbable(el){var tn=(el.tagName||'').toLowerCase();if(tn==='a')return el.hasAttribute('href');return /^(button|input|select|textarea|summary|iframe)$/.test(tn)}function isTabbable(el){var ti=safeAttr(el,'tabindex');if(ti!==null)return parseInt(ti,10)>=0;return isNativeTabbable(el)}function callout(el,color,msg){try{var r=el.getBoundingClientRect();var o=document.createElement('div');o.className='__a11y-mark';o.style.position='absolute';o.style.left=(r.left+window.scrollX)+'px';o.style.top=(r.top+window.scrollY)+'px';o.style.width=r.width+'px';o.style.height=r.height+'px';o.style.border='3px solid '+color;o.style.borderRadius='8px';o.style.boxShadow='0 0 0 2px rgba(0,0,0,0.2)';o.style.zIndex='2147483645';o.style.pointerEvents='none';document.body.appendChild(o);return o}catch(e){return null}}function flashShow(el,color,msg){if(!el||isInsideWidget(el))return;el.scrollIntoView({behavior:'smooth',block:'center',inline:'center'});callout(el,color,msg)}function eachNode(root,fn){try{root.querySelectorAll('*').forEach(fn)}catch(e){}}function summarize(el){var t=(el.tagName||'').toLowerCase();var id=el.id?'#'+el.id:'';var cls=el.className?'.'+el.className.trim().split(/s+/).slice(0,2).join('.') :'';var name=safeAttr(el,'aria-label')||el.textContent||'';name=name.trim().slice(0,50);return t+id+cls+(name?(' – "'+name+'"'):'')}function scanRoot(root,defs){var counts={purple:0,orange:0,red:0};eachNode(root,function(el){if(isInsideWidget(el))return;if(!isVisible(el))return;if(!isInteractive(el))return;var ti=safeAttr(el,'tabindex');var hasTiNeg=ti!==null&&parseInt(ti,10)===-1;if(hasTiNeg){counts.purple++;callout(el,'#b37feb','tabindex=-1');defs.push({sc:'2.1.1 Keyboard',severity:'High',element:summarize(el),issue:'Interactive element removed from tab order with tabindex=-1',el:el,color:'#b37feb'});return}var roleInteractive=hasInteractiveRole(el);var tabb=isTabbable(el);if(roleInteractive&&!tabb){counts.orange++;callout(el,'#faad14','ARIA interactive not tabbable');defs.push({sc:'2.1.1 Keyboard',severity:'High',element:summarize(el),issue:'Custom ARIA widget is not reachable by Tab navigation',el:el,color:'#faad14'});return}var tn=(el.tagName||'').toLowerCase();var isNative=/^(button|a|input|select|textarea|summary)$/.test(tn)&&((tn!=='a')||el.hasAttribute('href'));if(!roleInteractive&&!isNative&&hasClickLike(el)&&!tabb){counts.red++;callout(el,'#ff4d4f','Mouse-only interactive');defs.push({sc:'2.1.1 Keyboard',severity:'High',element:summarize(el),issue:'Custom interactive element operable by mouse/touch only',el:el,color:'#ff4d4f'})}});return counts}function addCounts(a,b){a.orange+=b.orange;a.purple+=b.purple;a.red+=b.red;a.skipped=(a.skipped||0)+(b.skipped||0)}function scanWindow(win,depth,defs){if(depth>8)return {orange:0,purple:0,red:0,skipped:0};var totals=scanRoot(win.document,defs);var frames=[];try{frames=win.document.querySelectorAll('iframe')}catch(e){frames=[]}frames.forEach(function(fr){try{var subwin=fr.contentWindow;if(subwin&&subwin.document){addCounts(totals,scanWindow(subwin,depth+1,defs))}else{totals.skipped++}}catch(e){totals.skipped++}});return totals}function buildPanel(){var p=document.createElement('div');p.className='keyboard-panel';var close=document.createElement('button');close.className='keyboard-close';close.textContent='×';close.onclick=function(){p.remove();clearAll()};p.appendChild(close);var logo=document.createElement('img');logo.className='keyboard-logo';logo.src='https://www.tsqsinc.com/static/media/logo-transparent.1f4456ea770d124c21cb.gif';logo.alt='TSQS Inc logo';logo.decoding='async';logo.referrerPolicy='no-referrer';p.appendChild(logo);var title=document.createElement('h3');title.className='keyboard-title';title.textContent='⌨%EF%B8%8E WCAG 2.1.1 Keyboard';p.appendChild(title);var sub=document.createElement('p');sub.className='keyboard-subtitle';sub.textContent='Success Criterion 2.1.1 — Keyboard (Level A)';p.appendChild(sub);var status=document.createElement('div');status.className='keyboard-status';status.innerHTML='<strong>Scanning...</strong>';p.appendChild(status);var body=document.createElement('div');body.className='keyboard-section';body.style.maxHeight='55vh';body.style.overflow='auto';p.appendChild(body);document.body.appendChild(p);return {root:p,body:body,status:status}}var ui=buildPanel();var defs=[];var totals=scanWindow(window,0,defs);ui.status.innerHTML='<strong>Compliance Status:</strong> <span class="keyboard-'+(totals.red+totals.orange+totals.purple>0?'fail':'pass')+'">'+(totals.red+totals.orange+totals.purple>0?'FAIL':'PASS')+'</span>';if(defs.length>0){var tbl=document.createElement('table');tbl.className='keyboard-table';var thead=document.createElement('thead');var headerRow=document.createElement('tr');['SC','Severity','Element','Issue Description','Show'].forEach(function(headerText){var th=document.createElement('th');th.textContent=headerText;headerRow.appendChild(th)});thead.appendChild(headerRow);tbl.appendChild(thead);var tbody=document.createElement('tbody');defs.forEach(function(d){var tr=document.createElement('tr');function td(txt){var e=document.createElement('td');e.textContent=txt;return e}tr.appendChild(td(d.sc));tr.appendChild(td(d.severity));tr.appendChild(td(d.element));tr.appendChild(td(d.issue));var tdBtn=document.createElement('td');var btn=document.createElement('button');btn.textContent='Show';btn.className='keyboard-btn';btn.onclick=function(){flashShow(d.el,d.color,'Element')};tdBtn.appendChild(btn);tr.appendChild(tdBtn);tbody.appendChild(tr)});tbl.appendChild(tbody);ui.body.innerHTML='';ui.body.appendChild(tbl)}else{ui.body.innerHTML='<div class="keyboard-section success"><strong>✅ No keyboard accessibility issues found!</strong><br>All interactive elements are properly accessible via keyboard navigation.</div>'}var isDragging=false,offsetX=0,offsetY=0;ui.root.addEventListener('mousedown',function(e){if(e.target!==ui.root.querySelector('.keyboard-close')){isDragging=true;offsetX=e.clientX-ui.root.offsetLeft;offsetY=e.clientY-ui.root.offsetTop;e.preventDefault();}});document.addEventListener('mousemove',function(e){if(isDragging){ui.root.style.left=(e.clientX-offsetX)+'px';ui.root.style.top=(e.clientY-offsetY)+'px';ui.root.style.transform='none';}});document.addEventListener('mouseup',function(){isDragging=false});console.log('⌨%EF%B8%8E WCAG 2.1.1 Keyboard Accessibility Scan Complete!')}catch(e){alert('Keyboard Accessibility Error: '+e.message)}})();`,

    'language-of-page': `javascript:(function(){try{var existing=document.querySelectorAll('.lang-panel,.lang-style');existing.forEach(function(el){el.remove()});var styles=document.createElement('style');styles.className='lang-style';styles.innerHTML='.lang-panel{position:fixed;top:20px;left:50%;transform:translateX(-50%);max-width:520px;width:90%;background:rgba(255,255,255,0.98);border:1px solid #ddd;border-radius:12px;padding:20px;z-index:10000;font-family:-apple-system,BlinkMacSystemFont,"Segue UI",Arial,sans-serif;font-size:13px;box-shadow:0 12px 35px rgba(0,0,0,0.2);cursor:move;}.lang-header{position:relative;margin-bottom:15px;min-height:48px;}.lang-logo{width:48px;height:48px;object-fit:contain;border-radius:4px;float:left;margin-right:12px;}.lang-title{color:#007bff;font-size:18px;font-weight:600;margin:0;line-height:48px;text-align:center;}.lang-subtitle{color:#666;font-size:12px;margin:0 0 15px 0;clear:both;}.lang-status{display:flex;align-items:center;gap:8px;margin-bottom:15px;font-weight:600;}.lang-pass{background:#28a745;color:white;padding:4px 12px;border-radius:16px;font-size:11px;}.lang-fail{background:#dc3545;color:white;padding:4px 12px;border-radius:16px;font-size:11px;}.lang-section{background:rgba(248,249,250,0.8);border:1px solid #dee2e6;border-radius:8px;margin:10px 0;padding:15px;}.lang-section.success{background:rgba(212,237,218,0.8);border-color:#badbcc;}.lang-section.error{background:rgba(248,215,218,0.8);border-color:#f1aeb5;}.lang-close{position:absolute;top:15px;right:15px;background:#dc3545;color:white;border:none;border-radius:50%;width:24px;height:24px;font-size:12px;cursor:pointer;}.lang-close:hover{background:#c82333;}.lang-table{width:100%;border-collapse:collapse;font-size:12px;}.lang-table th{background:#f8f9fa;font-weight:600;padding:8px;text-align:left;border-bottom:2px solid #dee2e6;}.lang-table td{padding:8px;border-bottom:1px solid #eee;vertical-align:top;}.lang-btn{background:#007bff;color:white;border:none;border-radius:6px;padding:4px 8px;cursor:pointer;font-size:11px;}.lang-btn:hover{background:#0069d9;}.lang-code{background:#f8f9fa;color:#495057;padding:2px 6px;border-radius:4px;font-family:Monaco,Consolas,monospace;font-size:11px;}.lang-detail{margin:8px 0;display:flex;justify-content:space-between;align-items:center;}';document.head.appendChild(styles);function clearAll(){document.querySelectorAll('.lang-panel,.lang-style').forEach(el=>el.remove())}function buildPanel(){var p=document.createElement('div');p.className='lang-panel';var close=document.createElement('button');close.className='lang-close';close.textContent='×';close.onclick=function(){clearAll()};p.appendChild(close);var logo=document.createElement('img');logo.className='lang-logo';logo.src='https://www.tsqsinc.com/static/media/logo-transparent.1f4456ea770d124c21cb.gif';logo.alt='TSQS Inc logo';logo.decoding='async';logo.referrerPolicy='no-referrer';p.appendChild(logo);var title=document.createElement('h3');title.className='lang-title';title.textContent='🌐 WCAG 3.1.1 Language of Page';p.appendChild(title);var sub=document.createElement('p');sub.className='lang-subtitle';sub.textContent='Success Criterion 3.1.1 — Language of Page (Level A)';p.appendChild(sub);var status=document.createElement('div');status.className='lang-status';status.innerHTML='<strong>Analyzing...</strong>';p.appendChild(status);var body=document.createElement('div');body.className='lang-section';body.style.maxHeight='55vh';body.style.overflow='auto';p.appendChild(body);document.body.appendChild(p);return {root:p,body:body,status:status}}var validLangs=['aa','ab','ae','af','ak','am','an','ar','as','av','ay','az','ba','be','bg','bh','bi','bm','bn','bo','br','bs','ca','ce','ch','co','cr','cs','cu','cv','cy','da','de','dv','dz','ee','el','en','eo','es','et','eu','fa','ff','fi','fj','fo','fr','fy','ga','gd','gl','gn','gu','gv','ha','he','hi','ho','hr','ht','hu','hy','hz','ia','id','ie','ig','ii','ik','io','is','it','iu','ja','jv','ka','kg','ki','kj','kk','kl','km','kn','ko','kr','ks','ku','kv','kw','ky','la','lb','lg','li','ln','lo','lt','lu','lv','mg','mh','mi','mk','ml','mn','mr','ms','mt','my','na','nb','nd','ne','ng','nl','nn','no','nr','nv','ny','oc','oj','om','or','os','pa','pi','pl','ps','pt','qu','rm','rn','ro','ru','rw','sa','sc','sd','se','sg','si','sk','sl','sm','sn','so','sq','sr','ss','st','su','sv','sw','ta','te','tg','th','ti','tk','tl','tn','to','tr','ts','tt','tw','ty','ug','uk','ur','uz','ve','vi','vo','wa','wo','xh','yi','yo','za','zh','zu'];var langNames={'en':'English','es':'Spanish','fr':'French','de':'German','it':'Italian','pt':'Portuguese','ru':'Russian','ja':'Japanese','ko':'Korean','zh':'Chinese','ar':'Arabic','hi':'Hindi','tr':'Turkish','pl':'Polish','nl':'Dutch','sv':'Swedish','da':'Danish','no':'Norwegian','fi':'Finnish','he':'Hebrew','en-us':'English (US)','en-gb':'English (UK)','zh-cn':'Chinese (Simplified)','zh-tw':'Chinese (Traditional)'};var ui=buildPanel();var htmlEl=document.documentElement||document.getElementsByTagName('html')[0];var langAttr=htmlEl?htmlEl.getAttribute('lang'):null;var xmlLangAttr=htmlEl?htmlEl.getAttribute('xml:lang'):null;var issues=[];var passes=[];var result={hasHtml:!!htmlEl,hasLang:!!langAttr,langValue:langAttr||'',xmlLangValue:xmlLangAttr||'',isValid:false,isEmpty:false,langName:'Unknown'};if(result.hasLang){result.langValue=result.langValue.trim();result.isEmpty=result.langValue==='';if(!result.isEmpty){var primaryLang=result.langValue.toLowerCase().split('-')[0];result.isValid=validLangs.indexOf(primaryLang)!==-1;result.langName=langNames[result.langValue.toLowerCase()]||langNames[primaryLang]||primaryLang.toUpperCase();if(result.isValid){passes.push({sc:'3.1.1 Language',severity:'Pass',element:'HTML element',issue:'Valid language code: "'+result.langValue+'" ('+result.langName+')',type:'success'});}else{issues.push({sc:'3.1.1 Language',severity:'High',element:'HTML element',issue:'Invalid language code: "'+result.langValue+'"',type:'error'});}}else{issues.push({sc:'3.1.1 Language',severity:'High',element:'HTML element',issue:'Empty lang attribute on HTML element',type:'error'});}}else{issues.push({sc:'3.1.1 Language',severity:'High',element:'HTML element',issue:'Missing lang attribute on HTML element',type:'error'});}if(result.xmlLangValue&&result.xmlLangValue!==result.langValue){issues.push({sc:'3.1.1 Language',severity:'Medium',element:'HTML element',issue:'xml:lang attribute differs from lang attribute',type:'warning'});}var allItems=issues.concat(passes);var hasErrors=issues.length>0;ui.status.innerHTML='<strong>Compliance Status:</strong> <span class="lang-'+(hasErrors?'fail':'pass')+'">'+(hasErrors?'FAIL':'PASS')+'</span>';if(allItems.length>0){var tbl=document.createElement('table');tbl.className='lang-table';var thead=document.createElement('thead');var headerRow=document.createElement('tr');['SC','Status','Element','Description'].forEach(function(txt){var th=document.createElement('th');th.textContent=txt;headerRow.appendChild(th)});thead.appendChild(headerRow);tbl.appendChild(thead);var tbody=document.createElement('tbody');allItems.forEach(function(item){var tr=document.createElement('tr');if(item.type==='error'||item.type==='warning'){tr.style.backgroundColor='rgba(248,215,218,0.3)';}else{tr.style.backgroundColor='rgba(212,237,218,0.3)';}function td(txt){var e=document.createElement('td');e.textContent=txt;return e}tr.appendChild(td(item.sc));tr.appendChild(td(item.severity));tr.appendChild(td(item.element));tr.appendChild(td(item.issue));tbody.appendChild(tr)});tbl.appendChild(tbody);ui.body.innerHTML='';ui.body.appendChild(tbl);var detailsDiv=document.createElement('div');detailsDiv.style.marginTop='15px';detailsDiv.innerHTML='<div class="lang-detail"><strong>Current Language:</strong> <span class="lang-code">'+(result.langValue||'Not specified')+'</span></div>'+(result.langName!=='Unknown'?'<div class="lang-detail"><strong>Language Name:</strong> '+result.langName+'</div>':'')+'<div class="lang-detail"><strong>HTML Element:</strong> '+(result.hasHtml?'Found':'Missing')+'</div>'+(result.xmlLangValue?'<div class="lang-detail"><strong>xml:lang:</strong> <span class="lang-code">'+result.xmlLangValue+'</span></div>':'');ui.body.appendChild(detailsDiv);}else{ui.body.innerHTML='<div class="lang-section success"><strong>✅ Language properly identified!</strong><br>The page language is correctly specified.</div>';}var isDragging=false,offsetX=0,offsetY=0;ui.root.addEventListener('mousedown',function(e){if(e.target!==ui.root.querySelector('.lang-close')){isDragging=true;offsetX=e.clientX-ui.root.offsetLeft;offsetY=e.clientY-ui.root.offsetTop;e.preventDefault();}});document.addEventListener('mousemove',function(e){if(isDragging){ui.root.style.left=(e.clientX-offsetX)+'px';ui.root.style.top=(e.clientY-offsetY)+'px';ui.root.style.transform='none';}});document.addEventListener('mouseup',function(){isDragging=false});document.addEventListener('keydown',function(e){if(e.key==='Escape'){clearAll()}});console.log('🌐 WCAG 3.1.1 Language of Page Scan Complete!')}catch(e){alert('Language Accessibility Error: '+e.message)}})();`,

    'bypass-blocks': `javascript:(function(){try{var existingElements=document.querySelectorAll('.bypass-panel, .bypass-style');existingElements.forEach(function(el){el.remove();});var styles=document.createElement('style');styles.className='bypass-style';styles.innerHTML='.bypass-panel{position:fixed;top:20px;left:20px;background:rgba(255,255,255,0.98);border:1px solid #ddd;border-radius:12px;padding:20px;z-index:10000;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Arial,sans-serif;font-size:13px;width:480px;box-shadow:0 12px 35px rgba(0,0,0,0.2);}.bypass-title{color:#007bff;font-size:18px;font-weight:600;margin:0 0 10px 0;text-align:center;line-height:48px;}.bypass-logo{width:48px;height:48px;object-fit:contain;border-radius:4px;float:left;margin-right:12px;}.bypass-subtitle{color:#666;font-size:12px;margin:0 0 15px 0;clear:both;}.bypass-status{display:flex;align-items:center;gap:8px;margin-bottom:15px;font-weight:600;}.bypass-pass{background:#28a745;color:white;padding:4px 12px;border-radius:16px;font-size:11px;}.bypass-fail{background:#dc3545;color:white;padding:4px 12px;border-radius:16px;font-size:11px;}.bypass-section{background:rgba(248,249,250,0.8);border:1px solid #dee2e6;border-radius:8px;margin:10px 0;padding:15px;}.bypass-section.success{background:rgba(212,237,218,0.8);border-color:#badbcc;}.bypass-section.error{background:rgba(248,215,218,0.8);border-color:#f1aeb5;}.bypass-close{position:absolute;top:15px;right:15px;background:#dc3545;color:white;border:none;border-radius:50%;width:24px;height:24px;font-size:12px;cursor:pointer;}.bypass-close:hover{background:#c82333;}';document.head.appendChild(styles);var header=document.querySelector('header');var footer=document.querySelector('footer, section[role="contentinfo"]');var hasHeader=!!header;var hasFooter=!!footer;var hasSkipToMain=false;var hasSkipToFooter=false;var skipLinks=document.querySelectorAll('a[href^="#"]');var results={hasHeader:hasHeader,hasFooter:hasFooter,skipLinks:[],hasSkipToMain:false,hasSkipToFooter:false,compliance:'fail',issues:[],message:'',footerMessage:''};Array.from(skipLinks).forEach(function(link){var text=link.textContent.trim().toLowerCase();var href=link.getAttribute('href').toLowerCase();if((text.includes('skip to main')||text.includes('skip to content')||text.includes('main content')||href.includes('main')||href.includes('content'))&&!text.includes('footer')){results.hasSkipToMain=true;results.skipLinks.push({text:link.textContent.trim(),type:'main',element:link});}if((text.includes('skip to footer')||text.includes('footer')||href.includes('footer'))&&!text.includes('main')){results.hasSkipToFooter=true;results.skipLinks.push({text:link.textContent.trim(),type:'footer',element:link});}});if(!results.hasHeader){results.compliance='pass';results.message='✅ No header found - bypass links not required';}else if(results.hasSkipToMain){results.compliance='pass';results.message='✅ "Skip to main content" link found before header';}else{results.compliance='fail';results.message='❌ Missing "Skip to main content" link before header';results.issues.push('Header present but no "Skip to main content" link found');}if(results.hasFooter){if(results.hasSkipToFooter){results.footerMessage='✅ Footer found with "Skip to footer" link - compliance pass';}else{results.footerMessage='ℹ%EF%B8%8F Footer found (skip to footer link not required)';}}else{results.footerMessage='ℹ%EF%B8%8F No footer found';}var panel=document.createElement('div');panel.className='bypass-panel';panel.innerHTML='<button class="bypass-close" aria-label="Close dialog">×</button><img class="bypass-logo" src="https://www.tsqsinc.com/static/media/logo-transparent.1f4456ea770d124c21cb.gif" alt="TSQS Inc logo" decoding="async" referrerpolicy="no-referrer"><h3 class="bypass-title">⏭%EF%B8%8F WCAG 2.4.1 Bypass Blocks</h3><p class="bypass-subtitle">Success Criterion 2.4.1 — Bypass Blocks (Level A)</p><div class="bypass-status"><strong>Compliance Status:</strong><span class="bypass-'+(results.compliance==='pass'?'pass':'fail')+'">'+(results.compliance==='pass'?'PASS':'FAIL')+'</span></div><div style="margin-bottom:15px;"><strong>Header Result:</strong> '+results.message+'</div><div style="margin-bottom:15px;"><strong>Footer Result:</strong> '+results.footerMessage+'</div>'+(results.compliance==='pass'?'<div class="bypass-section success"><strong>✅ Compliance Status</strong>'+(results.hasHeader?'Header bypass requirement met':'No header found - compliance by default')+(results.hasFooter&&results.hasSkipToFooter?'Footer skip link provided (bonus compliance)':'')+'</div>':'<div class="bypass-section error"><strong>❌ Issues Found</strong>'+results.issues.join('')+'</div>')+'<div class="bypass-section"><strong>🔧 Technical Details</strong><strong>Header found:</strong> '+(results.hasHeader?'Yes':'No')+'<strong>Footer found:</strong> '+(results.hasFooter?'Yes':'No')+'<strong>Skip to main:</strong> '+(results.hasSkipToMain?'✅ Found':'❌ Missing')+(results.hasFooter?'<strong>Skip to footer:</strong> '+(results.hasSkipToFooter?'✅ Found':'○ Not found'):'')+'<strong>Total skip links:</strong> '+results.skipLinks.length+'</div>'+(results.skipLinks.length>0?'<div class="bypass-section"><strong>📋 Skip Links Detected</strong>'+results.skipLinks.map(function(link){return'- "'+link.text+'" ['+link.type.toUpperCase()+']';}).join('')+'</div>':'')+'<div class="bypass-section"><strong>📚 Validation Rules</strong><strong>FAIL:</strong> If header exists but no "Skip to main content" link<strong>PASS:</strong> No header OR header with "Skip to main content" link<strong>Footer:</strong> Optional - if present with skip link, shows bonus compliance</div>';panel.querySelector('.bypass-close').onclick=function(){panel.remove();document.querySelector('.bypass-style').remove();};document.body.appendChild(panel);console.log('⏭%EF%B8%8F WCAG 2.4.1 Bypass Blocks Analysis Complete!');console.log('Header found:',results.hasHeader);console.log('Footer found:',results.hasFooter);console.log('Skip to main:',results.hasSkipToMain);console.log('Skip to footer:',results.hasSkipToFooter);console.log('Compliance:',results.compliance.toUpperCase());console.log('Header message:',results.message);console.log('Footer message:',results.footerMessage);if(results.issues.length>0){console.warn('Issues:',results.issues);}}catch(e){alert('Bypass Blocks Error: '+e.message);}})();`,

    'target-size-minimum': `javascript:(function(){try{var existing=document.querySelectorAll('.bypass-panel,.bypass-style');existing.forEach(el=>el.remove());var styles=document.createElement('style');styles.className='bypass-style';styles.innerHTML='.bypass-panel{position:fixed;top:20px;left:50%;transform:translateX(-50%);max-width:520px;width:90%;background:rgba(255,255,255,0.98);border:1px solid #ddd;border-radius:12px;padding:20px;z-index:10000;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Arial,sans-serif;font-size:13px;box-shadow:0 12px 35px rgba(0,0,0,0.2)}.bypass-header{display:flex;align-items:center;justify-content:center;position:relative;margin-bottom:10px;cursor:move;padding:5px 0}.bypass-logo{position:absolute;left:0;height:40px;width:auto}.bypass-title{color:#007bff;font-size:18px;font-weight:600;margin:0;text-align:center;flex:1;pointer-events:none}.bypass-subtitle{color:#666;font-size:12px;margin:0 0 15px 0;text-align:center}.bypass-close{position:absolute;top:10px;right:10px;background:#dc3545;color:white;border:none;border-radius:50%;width:28px;height:28px;font-size:16px;cursor:pointer;z-index:10001;line-height:1}.bypass-close:hover{background:#c82333}.bypass-status{display:flex;align-items:center;gap:12px;margin-bottom:15px;font-weight:600}.bypass-pass{background:#28a745;color:white;padding:4px 12px;border-radius:16px;font-size:11px}.bypass-fail{background:#dc3545;color:white;padding:4px 12px;border-radius:16px;font-size:11px}.bypass-section{background:rgba(248,249,250,0.8);border:1px solid #dee2e6;border-radius:8px;margin:10px 0;padding:15px}.bypass-section.success{background:rgba(212,237,218,0.8);border-color:#badbcc}.bypass-section.error{background:rgba(248,215,218,0.8);border-color:#f1aeb5}.bypass-no-issues{background:rgba(212,237,218,0.9);border:1px solid #badbcc;border-radius:8px;padding:20px;text-align:center;color:#155724;font-size:16px;font-weight:600;margin:10px 0}.bypass-table{width:100%;border-collapse:collapse;font-size:12px}.bypass-table th{background:#f8f9fa;font-weight:600;padding:8px;text-align:left;border-bottom:2px solid #dee2e6}.bypass-table td{padding:8px;border-bottom:1px solid #eee;vertical-align:top}.bypass-btn{background:#007bff;color:white;border:none;border-radius:6px;padding:4px 8px;cursor:pointer;font-size:11px}.bypass-btn:hover{background:#0069d9}';document.head.appendChild(styles);function clearAll(){document.querySelectorAll('.__tsm_final_overlay,.__tsm_final_circle').forEach(el=>el.remove());document.querySelectorAll('.bypass-panel').forEach(el=>el.remove());window.removeEventListener('scroll',refresh,true);window.removeEventListener('resize',refresh,true);}var panel=document.createElement('div');panel.className='bypass-panel';panel.setAttribute('role','dialog');panel.setAttribute('aria-label','Target Size Issues');var closeBtn=document.createElement('button');closeBtn.className='bypass-close';closeBtn.textContent='×';closeBtn.onclick=clearAll;panel.appendChild(closeBtn);var header=document.createElement('div');header.className='bypass-header';var logo=document.createElement('img');logo.className='bypass-logo';logo.src='https://www.tsqsinc.com/static/media/logo-transparent.1f4456ea770d124c21cb.gif';logo.alt='TSQS Logo';header.appendChild(logo);var title=document.createElement('h3');title.className='bypass-title';title.textContent='📐 Target Size Issues';header.appendChild(title);panel.appendChild(header);var subtitle=document.createElement('p');subtitle.className='bypass-subtitle';subtitle.textContent='WCAG 2.5.8 — Target Size (Level AA)';panel.appendChild(subtitle);var status=document.createElement('div');status.className='bypass-status';status.innerHTML='<strong>Failures:</strong> <span class="bypass-fail" id="target-count">…</span>';panel.appendChild(status);var body=document.createElement('div');body.className='bypass-section';body.style.maxHeight='50vh';body.style.overflow='auto';panel.appendChild(body);document.body.appendChild(panel);var PX=24,DIAM=24,R=DIAM/2;function isHidden(el){try{var s=getComputedStyle(el);}catch{return true;}if(s.display==='none'||s.visibility==='hidden'||parseFloat(s.opacity)===0)return true;var r=el.getBoundingClientRect();return r.width===0||r.height===0;}function isInline(el){var s=getComputedStyle(el);if(s.display.includes('inline')||el.closest('p,li,dd,dt,code,pre')){var lh=parseFloat(s.lineHeight);if(lh>0)return true;}return false;}function isUA(el){if(el.tagName.toLowerCase()==='input'){var t=el.type.toLowerCase();if({date:1,color:1,range:1,time:1,month:1,week:1}[t]){var s=getComputedStyle(el);if((s.width==='auto'||parseFloat(s.width)===0)&&(s.height==='auto'||parseFloat(s.height)===0)&&s.padding==='0px')return true;}}return false;}function isEssential(el){return !!el.closest('[data-map],[data-chart],.map,.chart,svg[role="img"],canvas');}function isBypass(el){var txt=(el.textContent||'').toLowerCase(),h=(el.getAttribute&&el.getAttribute('href')||'').toLowerCase();return /skip/.test(txt)||/#main|#content/.test(h)||/skip|bypass/.test(el.id||'');}var sel=['a[href]:not([tabindex="-1"])','button:not([tabindex="-1"])','input:not([type="hidden"]):not([tabindex="-1"])','select:not([tabindex="-1"])','textarea:not([tabindex="-1"])','[role="button"]:not([aria-disabled="true"])','[role="link"]','[onclick],[onmousedown],[onmouseup],[onpointerdown],[onpointerup]','[tabindex]:not([tabindex="-1"])'],elems=[];sel.forEach(s=>{try{document.querySelectorAll(s).forEach(el=>elems.push(el));}catch{}});elems=[...new Set(elems)];var data=elems.filter(el=>!isHidden(el)&&!isBypass(el)).map(el=>{var r=el.getBoundingClientRect();return{el,rect:r,center:{x:r.left+r.width/2,y:r.top+r.height/2},undersized:r.width<PX||r.height<PX,inline:isInline(el),ua:isUA(el),essential:isEssential(el)}});var fails=data.reduce((a,d,i,arr)=>{if(d.inline||d.ua||d.essential||!d.undersized)return a;for(var j=0;j<arr.length;j++){if(i===j)continue;var o=arr[j];if(o.inline||o.ua||o.essential)continue;var dx=d.center.x-o.center.x,dy=d.center.y-o.center.y;if(Math.hypot(dx,dy)<=DIAM){a.push(i);break;}}return a;},[]);document.getElementById('target-count').textContent=fails.length;if(fails.length===0){status.innerHTML='<strong>Failures:</strong> <span class="bypass-pass">0</span>';var noIssues=document.createElement('div');noIssues.className='bypass-no-issues';noIssues.innerHTML='✅ No Target Size Issues Found';body.innerHTML='';body.appendChild(noIssues);}else{var markers=fails.map(_=>({box:document.createElement('div'),dot:document.createElement('div')}));fails.forEach((idx,i)=>{var d=data[idx],m=markers[i];m.box.className='__tsm_final_overlay';Object.assign(m.box.style,{position:'absolute',border:'2px solid #cc3333',pointerEvents:'none',zIndex:2147483646});m.dot.className='__tsm_final_circle';Object.assign(m.dot.style,{position:'absolute',width:DIAM+'px',height:DIAM+'px',border:'2px dashed #cc3333',borderRadius:'50%',background:'rgba(255,0,0,0.1)',pointerEvents:'none',zIndex:2147483646});document.body.appendChild(m.box);document.body.appendChild(m.dot);});function refresh(){fails.forEach((idx,i)=>{var d=data[idx],m=markers[i],r=d.el.getBoundingClientRect(),l=r.left+scrollX,t=r.top+scrollY;Object.assign(m.box.style,{left:l+'px',top:t+'px',width:r.width+'px',height:r.height+'px'});Object.assign(m.dot.style,{left:(l+r.width/2-R)+'px',top:(t+r.height/2-R)+'px'});});}window.addEventListener('scroll',refresh,true);window.addEventListener('resize',refresh,true);var tbl=document.createElement('table');tbl.className='bypass-table';var thead=document.createElement('thead'),hdr=document.createElement('tr');['Sr. No','SC','Element','Description','Show'].forEach(t=>{var th=document.createElement('th');th.textContent=t;hdr.appendChild(th);});thead.appendChild(hdr);tbl.appendChild(thead);var tbody=document.createElement('tbody');fails.forEach((idx,i)=>{var d=data[idx],tr=document.createElement('tr');function cell(txt){var td=document.createElement('td');td.textContent=txt;return td;}tr.appendChild(cell(String(i+1)));tr.appendChild(cell('2.5.8'));var nm=d.el.tagName.toLowerCase()+(d.el.id?('#'+d.el.id):'')+(d.el.className?('.'+d.el.className.split(/\s+/)[0]):'');tr.appendChild(cell(nm+' ['+Math.round(d.rect.width)+'×'+Math.round(d.rect.height)+']'));tr.appendChild(cell('Target <24×24px and spacing intersects another'));var tdBtn=document.createElement('td'),btn=document.createElement('button');btn.textContent='Show';btn.className='bypass-btn';btn.onclick=function(){d.el.scrollIntoView({behavior:'smooth',block:'center'});};tdBtn.appendChild(btn);tr.appendChild(tdBtn);tbody.appendChild(tr);});tbl.appendChild(tbody);body.appendChild(tbl);}var isDragging=false,offsetX=0,offsetY=0;header.addEventListener('mousedown',function(e){if(e.target===header||e.target===title){isDragging=true;var rect=panel.getBoundingClientRect();offsetX=e.clientX-rect.left;offsetY=e.clientY-rect.top;e.preventDefault();}});document.addEventListener('mousemove',function(e){if(isDragging){panel.style.left=(e.clientX-offsetX)+'px';panel.style.top=(e.clientY-offsetY)+'px';panel.style.transform='none';}});document.addEventListener('mouseup',function(){isDragging=false;});}catch(e){alert('Target Size Bookmarklet Error: '+e.message);}})();`,

    'info-and-relationships': `javascript:(function(){try{document.querySelectorAll('.relationship-info').forEach(function(el){el.remove();});var elementsWithInfo=document.querySelectorAll('[aria-labelledby], [aria-describedby], [aria-controls], [for], label, legend, caption');var count=0;elementsWithInfo.forEach(function(el){var info=[];var tagName=el.tagName.toLowerCase();if(el.getAttribute('aria-labelledby'))info.push('labelledby');if(el.getAttribute('aria-describedby'))info.push('describedby');if(el.getAttribute('aria-controls'))info.push('controls');if(el.getAttribute('for'))info.push('for');if(tagName==='label'||tagName==='legend'||tagName==='caption')info.push(tagName);if(info.length>0){el.style.outline='2px solid #e67320';el.style.outlineOffset='2px';var label=document.createElement('div');label.className='relationship-info';label.style.cssText='position:absolute;background:#e67320;color:white;padding:2px 6px;font-size:10px;border-radius:3px;z-index:9999;font-family:Arial,sans-serif;max-width:150px;';label.textContent=info.join(', ').toUpperCase();var rect=el.getBoundingClientRect();label.style.top=(rect.top+window.scrollY-15)+'px';label.style.left=(rect.left+window.scrollX)+'px';document.body.appendChild(label);count++;}});var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ '+count+' elements with relationships highlighted';document.body.appendChild(msg);setTimeout(function(){msg.remove();},5000);}catch(e){alert('Error: '+e.message);}})();`,

    'display-anchors': `javascript:(function(){try{document.querySelectorAll('.anchor-info').forEach(function(el){el.remove();});var anchors=document.querySelectorAll('a[name], [id], a[href^="#"]');var count=0;anchors.forEach(function(anchor){var info=[];if(anchor.getAttribute('name'))info.push('name: '+anchor.getAttribute('name'));if(anchor.getAttribute('id'))info.push('id: '+anchor.getAttribute('id'));var href=anchor.getAttribute('href');if(href&&href.startsWith('#'))info.push('href: '+href);if(info.length>0){anchor.style.outline='2px solid #e67320';anchor.style.outlineOffset='2px';var label=document.createElement('div');label.className='anchor-info';label.style.cssText='position:absolute;background:#e67320;color:white;padding:3px 6px;font-size:10px;border-radius:3px;z-index:9999;font-family:Arial,sans-serif;max-width:200px;';label.textContent=info.join(' | ');var rect=anchor.getBoundingClientRect();label.style.top=(rect.top+window.scrollY-20)+'px';label.style.left=(rect.left+window.scrollX)+'px';document.body.appendChild(label);count++;}});var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ '+count+' anchors and targets displayed';document.body.appendChild(msg);setTimeout(function(){msg.remove();},5000);}catch(e){alert('Error: '+e.message);}})();`,

    'display-aria-roles': `javascript:(function(){try{document.querySelectorAll('.aria-info').forEach(function(el){el.remove();});var ariaElements=document.querySelectorAll('[role], [aria-label], [aria-labelledby], [aria-describedby], [aria-expanded], [aria-hidden], [aria-live]');var count=0;ariaElements.forEach(function(el){var ariaInfo=[];if(el.getAttribute('role'))ariaInfo.push('role='+el.getAttribute('role'));if(el.getAttribute('aria-label'))ariaInfo.push('label');if(el.getAttribute('aria-labelledby'))ariaInfo.push('labelledby');if(el.getAttribute('aria-describedby'))ariaInfo.push('describedby');if(el.getAttribute('aria-expanded'))ariaInfo.push('expanded='+el.getAttribute('aria-expanded'));if(el.getAttribute('aria-hidden'))ariaInfo.push('hidden='+el.getAttribute('aria-hidden'));if(el.getAttribute('aria-live'))ariaInfo.push('live='+el.getAttribute('aria-live'));if(ariaInfo.length>0){el.style.outline='2px solid #e67320';el.style.outlineOffset='2px';var label=document.createElement('div');label.className='aria-info';label.style.cssText='position:absolute;background:#e67320;color:white;padding:3px 6px;font-size:10px;border-radius:3px;z-index:9999;font-family:Arial,sans-serif;max-width:250px;overflow:hidden;';label.textContent=ariaInfo.join(' | ');var rect=el.getBoundingClientRect();label.style.top=(rect.top+window.scrollY-20)+'px';label.style.left=(rect.left+window.scrollX)+'px';document.body.appendChild(label);count++;}});var msg=document.createElement('div');msg.style.cssText='position:fixed;top:20px;right:20px;background:#e67320;color:white;padding:15px;border-radius:8px;z-index:10000;font-family:Arial,sans-serif;font-size:14px;box-shadow:0 4px 20px rgba(0,0,0,0.3);';msg.textContent='✓ '+count+' elements with ARIA attributes displayed';document.body.appendChild(msg);setTimeout(function(){msg.remove();},5000);}catch(e){alert('Error: '+e.message);}})();`,

    'display-tab-index': `javascript:(function(){try{var s=document.createElement('style');s.innerHTML='.tabindex-panel{position:fixed;top:20px;left:20px;background:rgba(255,255,255,0.98);border:1px solid #ddd;border-radius:12px;padding:20px;z-index:10000;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Arial,sans-serif;font-size:13px;width:400px;box-shadow:0 12px 35px rgba(0,0,0,0.2);cursor:move}.tabindex-header{display:flex;justify-content:center;align-items:center;position:relative}.tabindex-header:before{content:"";position:absolute;top:15px;left:20px;height:50px;width:50px;background-image:url(\'https://www.tsqsinc.com/static/media/logo-transparent.1f4456ea770d124c21cb.gif\');background-size:contain;background-repeat:no-repeat}.tabindex-title{margin:auto;font-size:18px;font-weight:600;text-align:center}.tabindex-close{position:absolute;top:15px;right:15px;background:#dc3545;color:#fff;border:none;border-radius:50%;width:24px;height:24px;font-size:14px;cursor:pointer}.tabindex-close:hover{background:#c82333}.tabindex-label{position:absolute !important;top:-25px !important;left:0 !important;background:#e67320 !important;color:white !important;padding:2px 6px !important;font-size:10px !important;font-weight:bold !important;border-radius:3px !important;z-index:9999 !important;font-family:Arial,sans-serif !important;pointer-events:none !important}.tabindex-positive{outline:3px solid #dc3545 !important;outline-offset:2px !important;position:relative !important}.tabindex-zero{outline:3px solid #28a745 !important;outline-offset:2px !important;position:relative !important}.tabindex-negative{outline:3px dashed #6c757d !important;outline-offset:2px !important;position:relative !important}.tabindex-default{outline:2px dotted #007bff !important;outline-offset:2px !important;position:relative !important}.tabindex-stats{margin:15px 0;padding:15px;background:#f8f9fa;border-radius:8px}.tabindex-count{font-size:14px;margin:5px 0}.tabindex-good{color:#28a745}.tabindex-bad{color:#dc3545}.tabindex-neutral{color:#6c757d}.tabindex-info{color:#007bff}';document.head.appendChild(s);var p=document.createElement('div');p.className='tabindex-panel';p.innerHTML='<div class="tabindex-header"><button class="tabindex-close">×</button><h3 class="tabindex-title">🔢 Tab Index Display</h3></div><div class="tabindex-stats"><div class="tabindex-count"><strong>Total Elements with Tabindex:</strong> <span class="tabindex-total">0</span></div><div class="tabindex-count"><span class="tabindex-good">✓ tabindex="0":</span> <span class="tabindex-zero-count">0</span></div><div class="tabindex-count"><span class="tabindex-bad">✗ Positive tabindex:</span> <span class="tabindex-positive-count">0</span></div><div class="tabindex-count"><span class="tabindex-neutral">⊝ tabindex="-1":</span> <span class="tabindex-negative-count">0</span></div><div class="tabindex-count"><span class="tabindex-info">○ Default focusable:</span> <span class="tabindex-default-count">0</span></div></div><div style="color:#666;font-size:12px;margin-top:10px;"><strong>Color Legend:</strong><br><span style="color:#28a745;">Green</span> = tabindex="0"<br><span style="color:#dc3545;">Red</span> = Positive tabindex<br><span style="color:#6c757d;">Gray dashed</span> = tabindex="-1"<br><span style="color:#007bff;">Blue dotted</span> = Default focusable</div>';document.body.appendChild(p);var e=document.querySelectorAll('[tabindex], a[href], button, input, select, textarea, [contenteditable="true"]'),t={positive:0,zero:0,negative:0,default:0};e.forEach(function(e){var n=e.getAttribute('tabindex'),r="tabindex-default",a="Default focusable";if(n){var i=parseInt(n,10);if(i>0){r="tabindex-positive",a='tabindex="'+n+'"',t.positive++}else if(i===0){r="tabindex-zero",a='tabindex="0"',t.zero++}else if(i===-1){r="tabindex-negative",a='tabindex="-1"',t.negative++}}else if(e.matches('a[href], button, input, select, textarea, [contenteditable="true"]')){r="tabindex-default",a="Default focusable",t.default++}if(r!=="tabindex-default"){e.classList.add(r);var o=document.createElement('span');o.className='tabindex-label',o.textContent=a,e.appendChild(o)}});document.querySelector('.tabindex-total').textContent=e.length;document.querySelector('.tabindex-positive-count').textContent=t.positive;document.querySelector('.tabindex-zero-count').textContent=t.zero;document.querySelector('.tabindex-negative-count').textContent=t.negative;document.querySelector('.tabindex-default-count').textContent=t.default;document.querySelector('.tabindex-close').addEventListener('click',function(){p.remove();document.querySelectorAll('.tabindex-positive,.tabindex-zero,.tabindex-negative,.tabindex-default').forEach(function(e){e.classList.remove('tabindex-positive','tabindex-zero','tabindex-negative','tabindex-default');var t=document.querySelector('.tabindex-label');t&&t.remove()})});var n=!1,r={x:0,y:0};p.addEventListener('mousedown',function(e){if(!e.target.closest('.tabindex-close')){n=!0,r.x=e.clientX-p.offsetLeft,r.y=e.clientY-p.offsetTop,e.preventDefault()}});document.addEventListener('mousemove',function(e){if(n){p.style.left=e.clientX-r.x+'px';p.style.top=e.clientY-r.y+'px'}});document.addEventListener('mouseup',function(){n=!1})}catch(e){alert('Tab Index Display Error: '+e.message)}})();`,
    
    'name-role-value': `javascript:(function(){var s=document.createElement('script');s.src='./Logic/logic.js';document.head.appendChild(s);})();`,
  };

  return bookmarklets[id] || 'javascript:alert("Bookmarklet not found");';
}